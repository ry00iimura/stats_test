# 対応のある３群の順位データの検定
対応のある３群の平均の差を検定するノンパラ手法。順位データ、外れ値を持つ量的データに有効

# 統計検定量 = Q値
## 求め方（例）
- A,B,Cさんがあるサービスの評価を4半期ごとに4回行ったことを想定する
- 全部で12の記録があるが、これらに対して、大きい（小さい）順に順位をつける。ただし、順位は、AさんならAさんの4回分の中でつけるし、BさんならBさんの4回の評価の中でつける。同じ値の場合は、2つの順位÷2の順位が両方の値の順位になる。
- 四半期ごとに順位の和を出す（順位和R)
- 各順位和に対して、以下の計算をし、Rの偏りの統計量を求める。（順位和1Q）^2  + （順位和2Q）^2 + （順位和3Q）^2 ＋ (順位和4Q)
- Rの偏りの統計量に対して以下の補正を行う（Q値）。これにより近似的にχ二乗分布させたQ値が求められる。 12/サンプル数(行数)×Rの偏りの統計量-3サンプル数(群数+1)

## 分布
- 3群の場合はサンプル数が9以下、4軍の場合は5以下で分布の形が変化する。
- 上記に当てはまらない大標本の場合はχ二乗分布に従う。

## 帰無仮説と対立仮説
- 帰無仮説:すべての母集団平均が等しい
- 対立仮説:少なくとも１つの水準の母集団平均が他の水準の平均とは異なる

## ポイント
- 群間（上の例では四半期）、つまり群同士の比較をしたとき、評価が安定していれば、Rの偏りの統計量は小さくなるので、帰無仮説を棄却しなくなる
- サンプル（行）ごとに順位を決めるので、個体差が考慮されている。

## ケンドールの一致係数
-- フリードマン検定では順位和Rを計算する際、各サンプル（行）ごとに順位を出す。例えば、Aさんは四半期評価が1位、2位、3位、4位の順で、Bさんは4位、3位、2位、1位の順だったとする。この例では、AさんとBさんの評価が完全に一致していないことになる。つまり、個体によって同じ期を全然違う感じに評価している。
-- こうした個体によってどれだけバラバラな評価をしているのかを示す指標がケンドールの一致係数。０～１の値をとり、完全に不一致の場合は０、完全に一致の場合は１となる。
-- W = サンプル別順位和の分散/サンプル別順位和の分散の理論最大値。　理論最大値＝群数（サンプル数-1)/12

# python code
https://github.com/iimuragumi/hello-world/blob/master/Friedman_test.ipynb

# 参考
https://github.com/Wotipati/statisticalHypothesisTests/tree/master/Friedman-test
https://machinelearningmastery.com/nonparametric-statistical-significance-tests-in-python/
https://omedstu.jimdofree.com/2018/01/10/%E3%82%B1%E3%83%B3%E3%83%89%E3%83%BC%E3%83%AB%E3%81%AE%E4%B8%80%E8%87%B4%E4%BF%82%E6%95%B0/